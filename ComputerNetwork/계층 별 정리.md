# 1. 물리 계층

## 📌 물리 계층
- **물리 계층: 시스템 간의 물리적인 연결과 전기 신호를 변환 및 제어**

> 💡 물리 계층은 0과 1로 이루어진 **비트열을 전기 신호로 변환하기 위해** 필요하다.

- 랜 카드: 0과 1의 정보를 전기 신호로 변환.
    - 0과 1의 정보 -> 랜 카드로 전송 -> 랜카드는 0과 1을 전기신호로 변환

- 전기 신호는 **디지털 신호**와 **아날로그 신호**가 있다.


## 📌 트위스트 페어 케이블(=LAN Cable, 랜 선)

- 네트워크 전송 매체: 데이터가 흐르는 물리적인 선로
    - 유선: 트위스트 페어 케이블, 광케이블..
    
    - 무선: 라디오파, 마이크로파, 적외선..

- **트위스트 페어 케이블: 8개의 구리선을 두 개씩 꼬아 만든 네 쌍의 전선**
    - UTP: Unshielded 트위스트 페어(비차페 연선)
    - STP: Shielded 트위스트 페어(차폐 연선)
> 💡 노이즈는 케이블에 전기 신호가 흐를 때 발생하며, Shield는 이러한  노이즈를 막는 역할을 한다. 구리선을 꼬아서 케이블을 만드는 이유 또한 노이즈를 막기 위함이다.

- 랜 케이블의 양쪽 끝에는 기기를 연결하기 위한 **RJ-45 커넥터**가 붙어 있다.

- Direct Cable & Cross Cable
    - Direct Cable: 구리 선 여덟 개를 같은 순서로 커넥터에 연결한 케이블
        - 1번 -> 1, 2번 -> 2
        - 3번 <- 3, 6번 <- 6
        - 컴퓨터와 스위치를 연결할 때 사용
    - Cross Cable: 구리 선 여덟 개 중 1번과 2번에 연결되는 구리 선을 다른 쪽 커넥터의 3번과 6번에 연결한 케이블
        - 1번 -> 3번, 2번 -> 6번
        - 3번 <- 1번, 6번 <- 2번 
        - 컴퓨터 간 직접 랜 케이블로 연결할 때 사용
> 💡Cross Cable 같은 경우 구리 선을 교차시킨 이유는 양쪽 컴퓨터 간 데이터 충돌을 방지하고 송/수신이 원활하도록 하기 위함이다.


## 📌 물리 계층에서 동작하는 리피터와 허브

- 리피터: 네트워크를 중계하기 위한 장비
    - 전기 신호를 복원하는 기능
    - 약해진 전기 신호를 증폭하는 기능
> 💡 오늘날 네트워크 장비가 리피터 기능을 지원하기 때문에 리피터를 잘 쓰지 않는다.

- 허브: 포트를 여러 개 갖고 있는 장비
    - 리피터 허브라고도 함
    - 리피터와 같이 전기 신호를 정형하고 증폭하는 기능을 갖고 있다.
    - 리피터는 1:1 통신만 가능하지만 허브는 포트가 여러개 있기 때문에 컴퓨터 여러 대와 통신할 수 있다.
> 💡허브는 컴퓨터 여러 대를 서로 연결하는 장치이기도 하지만, 특정 포트로부터 데이터를 받을 때 나머지 포트로도 데이터가 전송된다는 단점이 있으며, 이러한 이유로 **더미 허브**라고도 불린다.<br>
이를 해결하기 위한 장비로 **스위치**가 있다.

<br>

---

<br>

# 2. 데이터 링크 계층

## 📌 데이터 링크 계층

- 데이터 링크 계층: 네트워크 장비 간 신호를 주고 받는 규칙을 정하는 계층
    - **LAN에서 데이터를 주고 받기 위해 필요한 계층**
    - 일반적으로 가장 많이 사용되는 규칙이 **이더넷**이다.
    
- 이더넷: LAN에서 데이터를 정상적으로 주고 받기 위한 규칙.
    - 이더넷은 데이터 충돌을 막기 위한 규칙으로 CSMA/CD 방식을 사용한다.
    - 즉, 케이블에 데이터가 흐르고 있지 않으면 데이터를 보내고, 충돌이 발생하고 있는지 확인한다.
    - 하지만 오늘날 CSMA/CD 방식을 거의 사용하지 않고 **네트워크 장비인 스위치**를 사용한다.
 
> 💡 이더넷은 네트워크에 연결된 각 기기들이 48비트 길이의 고유의 MAC 주소를 가지고 이 주소를 이용해 상호간에 데이터를 주고 받을 수 있도록 만들어졌다. 전송 매체로는 BNC 케이블 또는 UTP, STP 케이블을 사용하며, 각 기기를 상호 연결시키는 데에는 허브, 네트워크 스위치, 리피터 등의 장치를 이용한다. <br> 참고: [위키백과 - 이더넷](https://ko.wikipedia.org/wiki/%EC%9D%B4%EB%8D%94%EB%84%B7)


## 📌 MAC 주소

- MAC (Media Access Control Address) = 물리주소
    - 랜 카드를 제조할 때 새기는 주소로, 전 세계에서 유일한 번호로 할당되어 있다.
    - 48bit(=6byte)로 구성되어 있는 주소다.
        - 24bit(=3byte): 제조사 번호
        - 24bit(=3byte): 제조사가 붙인 일련 번호

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/175815394-a944ecb1-a182-4c1e-b125-771dd0dec464.jpg" width="900" height="500" />
</p>


> 💡 ARP(Address Resolution Protocol): 목적지 컴퓨터의 ip 주소를 이용하여 MAC 주소를 찾기 위한 프로토콜. <br>
ARP request: 출발지 컴퓨터가 목적지 MAC 주소를 알아내기 위해 네트워크에 브로드캐스트<br>
ARP reply: 지정된 ip 주소를 가진 컴퓨터(목적지 컴퓨터 ip 주소)가 MAC 주소를 응답으로 보냄<br>
ARP Table: (출발지 컴퓨터가) MAC 주소를 얻은 후 **MAC 주소 + IP 주소의 매핑 정보**를 메모리에 보관하는데, 이 정보를 ARP 테이블이라 함.
    

## 📌 스위치

- Switch: 허브와 같이 포트를 여러 개 갖고 있는 장비로, 데이터 링크 계층에서 동작한다. 
    - **허브와 달리 데이터 충돌이 발생하지 않으며 허브보다 전송 속도가 향상된 장비이다.**
    - 스위치 = 레이어 2 스위치 = 스위칭 허브
    - **스위치의 가장 큰 특징은 내부에 MAC 주소 테이블이 있다는 것이다.**

- MAC 주소 테이블
    1. MAC 주소 테이블에는 **스위치 포트 번호 + MAC 주소**로 이루어져 있다.
    2. 초기 스위치의 MAC 주소 테이블에는 아무 것도 등록되어 있지 않음.
    3. 프레임(헤더+데이터+트레일러)이 전송되면 출발지 MAC 주소+포트 번호를 MAC 주소 테이블에 저장 (=**MAC 주소 학습 기능**)
    4. 프레임에 들어 있는 목적지 MAC 주소가 MAC 주소 테이블에 저장되어 있지 않다면, 목적지 포트 외에 다른 포트로도 프레임이 전송된다. (=**플러딩**)
    5. 프레임에 들어 있는 목적지 MAC 주소가 MAC 주소 테이블에 저장되어 있다면, 목적지 포트에만 프레임이 전송된다. (=**MAC 주소 필터링**)

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/175815631-6548129b-bb9b-4a09-b4d3-63036656ec83.jpg" width="900" height="500" />
</p>

- 허브의 **반이중 통신 방식** VS 스위치의 **전이중 통신 방식**
    - 반이중 통신: 회선 하나로 송,수신을 번갈아가면서 통신하는 방식
        - 반이중 통신은 회선 하나로 송,수신을 번갈아가며 사용하기 때문에 데이터를 동시에 전송하면 충돌이 발생한다.
        - 즉, 허브를 사용하면 충돌로 인해 네트워크 지연이 발생하기 때문에 오늘날 대부분 스위치를 사용한다.
        - 충돌이 발생할 때 충돌의 영향이 미치는 범위를 **충돌 도메인**이라 하는데, **허브로 연결되어 있는 컴퓨터 전체가 충돌 도메인이 되기 때문에** 충돌 도메인의 범위가 넓다.(즉, 네트워크 지연이 ↑)
    - 전이중 통신: 데이터의 송,수신을 동시에 통신하는 방식

<br>

---

<br>

# 3. 네트워크 계층

## 📌 네트워크 계층

- 네트워크 계층: 다른 네트워크에 있는 목적지로 데이터를 전송하기 위한 계층
    - 데이터 링크 계층: 이더넷 규칙을 기반으로 같은 네트워크에 있는 컴퓨터로 데이터를 전송

- **네트워크 계층의 프로토콜인 ip**를 기반으로 **라우터를 통해 다른 네트워크로 데이터를 전송**한다

## 📌 라우터

- 라우터: 다른 네트워크로 데이터를 보내기 위해 필요한 장비.

- 라우팅: 데이터의 목적지가 정해지면, **목적지 ip까지 어떤 경로로** 데이터를 보낼지 결정하는 것
    - **라우팅 테이블에 있는 경로 정보를 기반**으로 라우팅을 통해 최적의 경로로 데이터를 전송한다.

- 라우팅 테이블: 라우터 내에 있는 테이블로, 경로 정보를 등록하고 관리한다.

- 라우팅 프로토콜: 라우터 간 라우팅 정보를 교환하기 위한 프로토콜
    - 대표적으로 RIP, OSPF, BGP 등이 있다.

- 기본 게이트웨이(Default gateway): 기본적으로 설정된 라우팅 경로
    - 다른 네트워크로 데이터를 보낼 때, 어디로 전송해야 되는지 모를 경우 기본 게이트웨이로 전송한다.

    - 즉, 다른 네트워크로 데이터를 전송하기 위해선 기본 게이트웨이를 설정해야만 한다.
 
<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/175887574-7843973e-d82e-4bce-a5d5-83b1b3889b31.jpg" width="900" height="500" />
</p>

## 📌 IP와 IP 주소

- IP(Internet Protocol): 네트워크 계층에서의 규칙

    - 데이터 링크 계층: 이더넷과 프레임 / 네트워크 계층: ip와 ip 패킷

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/175887265-6cccbf2d-d5d5-41d9-bbce-081f72800b1e.jpg" width="900" height="400" />
</p>

- **IP 주소: 네트워크를 식별할 수 있는 주소(=어떤 네트워크의 어떤 컴퓨터인지 식별할 수 있는 주소)**
    - 데이터 링크 계층: MAC 주소 / 네트워크 계층: ip 주소
    - IP 주소는 ISP에게 받을 수 있으며, 크게
        - IPv4, IPv6
        - 공인 IP주소(라우터에 할당), 사설 IP주소(LAN 안에 있는 컴퓨터에 할당)가 있다.
    > 💡 LAN 안에 있는 컴퓨터에는 사설 IP주소를 할당할 수도 있고,<br> 라우터의 DHCP(Dynamic Host Configuration Protocol)기능을 사용하여 주소를 자동으로 할당할 수 있다.<br>
**DHCP: IP 주소를 자동으로 할당하는 프로토콜**
    
    - **IP주소 = 네트워크 ID(어떤 네트워크인지) + 호스트 ID(해당 네트워크의 어떤 컴퓨터인지)**

    - IP 주소는 네트워크의 규모에 따라 A ~ E 클래스로 나뉜다.
        
        | 클래스 이름 | 내용 |
        | :---: | :---: |
        | A 클래스: 8bit(네트워크 ID) + 24bit(호스트 ID) | 대규모 네트워크 주소 |
        | B 클래스: 16bit(네트워크 ID) + 16bit(호스트 ID) | 중형 네트워크 주소 |
        | C 클래스: 24bit(네트워크 ID) + 8bit(호스트 ID) | 소규모 네트워크 주소 |
        | D 클래스 | 멀티캐스트 주소 |
        | E 클래스 | 연구 및 특수용도 주소 |

    - IP 주소에는 네트워크 주소와 브로드캐스트 주소가 있다.
        - 네트워크 주소: 전체 네트워크에서 작은 네트워크를 식별하는데 사용
        - 브로드캐스트 주소: 하나의 네트워크에 있는 컴퓨터나 장비 모두에게 한 번에 데이터를 전송하는데 사용
        - **네트워크 주소, 브로드캐스트 주소는 자신의 IP주소로 설정하면 안된다.**

## 📌 서브넷

- 서브넷: 하나의 네트워크가 분할되어 나눠진 작은 네트워크
    - 네트워크를 분할하는 것을 **서브넷팅(subneting)** 이라 한다.

- IP 주소는 네트워크 ID + 호스트 ID로 이루어져 있는데, 서브넷팅하여 작은 네트워크로 분할하게 될 경우, **네트워크 ID + 서브넷 ID + 호스트 ID** 로 나누어지게 된다.

    - 여기서 **서브넷 ID는 호스트 ID에서 bit를 빌려 만든다.**

    - 서브넷 마스크: 네트워크 ID와 호스트 ID를 식별하기 위한 값으로, 서브넷팅을 할 때 **어디까지가 네트워크 ID고 어디부터가 호스트 ID인지 식별하기 위해** 사용한다. 

<br>

---

<br>

# 4. 전송 계층

## 📌 전송 계층

- 전송 계층: 목적지에 **(1) 신뢰할 수 있는 데이터를 전달**하고, **(2) 전송된 데이터의 목적지가 어떤 어플리케이션인지 식별**하는 계층
    
    - 신뢰할 수 있는 데이터를 전달하기 위해 전송 계층에는 **오류가 발생하면 재전송하도록 요청하는 기능**이 있다.

    - 네트워크 계층: 다른 네트워크에 있는 목적지로 데이터를 전송하기 위한 계층 ➡️ **데이터가 손상되거나 유실되어도 책임지지 않는다.**

- 전송 계층은 크게 **연결형 통신**과 **비연결형 통신**이 있다.

    - 연결형 통신(TCP): 신뢰성, 정확성에 중점을 두는 통신(신뢰할 수 있고 정확한 데이터를 전달)

        - 송신과 수신이 서로 확인하면서 통신하는 방식

        - **TCP(Transmission Control Protocol, 전송 제어 프로토콜): 연결형 통신 프로토콜**

    - 비연결형 통신(UDP): 효율성에 중점을 두는 통신(데이터를 효율적으로 빠르게 전달)

        - 송신이 수신을 확인하지 않고 일방적으로 데이터를 전송하는 방식으로, 대표적으로 **동영상**이 있다.

        - **UDP(User Datagram Protocol, 사용자 데이터그램 프로토콜): 비연결형 통신 프로토콜**
        
## 📌 TCP (Transmission Control Protocol)

- 세그먼트: TCP 헤더가 붙은 데이터

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/176114207-baf36ef8-ff61-4292-9c21-75fea12a32a2.jpg" width="900" height="500" />
</p>

- **3-way handshake**: 데이터를 보내기 전에 연결(가상의 통신로)을 확립하기 위해 패킷 요청을 세 번 교환하는 것.

    - TCP 헤더 내에 있는 **코드비트(6bit)** 에는 **SYN(연결 요청), ACK(확인 응답), FIN(연결 종료)** 등 6개의 bit들이 있다.

    - 코드비트 내에 있는 각 bit들은 초깃값이 0이며, 비트가 활성화되면 1로 바뀐다.

    - 연결(connection)을 확립하기 위해선 **SYN과 ACK이 필요**하며, 연결을 끊기 위해선 **FIN과 ACK이 필요**하다.

    - 3-way handshake를 할 때, **윈도우 크기**를 판단한다.
        
        - 윈도우 크기: 얼마나 많은 데이터를 저장할 수 있는지.
            
            - 대량의 데이터 > 버퍼의 크기 ➡️ 오버플로우 발생.

        > 💡 버퍼: 데이터(세그먼트)를 일시적으로 보관하는 장소

        > 💡오버플로우: 데이터가 넘쳐 흐르는 것을 말함

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/176114376-719c1e1d-72ea-42d3-af8a-d15d957c26bf.jpg" width="900" height="400" />
</p>

- 일련 번호와 확인 응답 번호: 3-way handshake 후 연결형 통신을 할 때 사용하는 번호
    
    - 일련 번호: 송신 ➡️ 수신 측에게 **"몇 번째 데이터인지 알려주는"** 역할 

    - 확인 응답 번호: 수신 ➡️ 송신 측에게 **"몇 번째 데이터를 수신했는지 알려주는"** 역할

    > 💡 재전송 제어: 데이터를 전송하는 동안 오류가 발생하면 일정 시간 대기한 뒤 재전송하는 것을 말한다.

- 포트 번호: 전송된 데이터의 목적지가 어떤 애플리케이션인지 식별하기 위한 번호

    - 전송계층에서 **2. 전송된 데이터의 목적지가 어떤 애플리케이션인지 식별** ➡️ 포트 번호
    
    - 전송계층에서 **1. 신뢰할 수 있는 데이터를 전달** ➡️ 연결 확립, 재전송 제어, 윈도우 제어

    - 포트번호는 0~65535번이 있으며,

        - 0~1023 포트 번호: well-known ports(주로 서버 측 애플리케이션에서 사용됨)
        
            | 애플리케이션 | 포트 번호 |
            | :---: | :---: |
            | SSH | 22 |
            | SMTP | 25 |
            | DNS | 53 |
            | HTTP | 80 |
            | POP3 | 110 |
            | HTTPS | 443 |
            
        - 1024 포트 번호: 예약되어 있지만 사용되지 않는 포트

        - 1025 포트 번호 이상(1025번 ~ ): 랜덤 포트 (클라이언트 측의 송신 포트)
            - 웹 브라우저로 접속할 때 웹 브라우저에는 임의의 포트가 자동으로 할당된다.

## 📌 UDP (User Datagram Protocol)

- UDP 데이터그램: UDP 헤더가 붙은 데이터
    
    - UDP 헤더에는 **출발,목적지 포트 번호**, 길이, 체크섬이 들어 있다.

- UDP는 LAN에 있는 컴퓨터 및 네트워크 장비에 데이터를 일괄적으로 보낼 수 있는데, 이를 **브로드캐스트(broadcast)** 라고 한다.

    - **유니캐스트(Unicast)**: TCP를 기반으로 하나의 네트워크 목적지에 데이터를 전송하는 방식
        - MAC 주소를 기반으로 수신 측의 IP 주소를 목적지로 하는 1:1 통신 방식이다.

    - **브로드캐스트(Broadcast)**: UDP를 기반으로 local LAN 상에 있는 모든 컴퓨터 및 네트워크 장비에 데이터를 일괄적으로 보내는 방식
        - 하나의 LAN에 있는 전체를 대상으로 데이터를 전송하는 1:多 통신 방식이다.
        
<br>

---

<br>

# 5. 응용 계층

## 📌 응용 계층

- 응용계층: 각 애플리케이션에 대응되는 데이터를 전송하는 역할

    - 클라이언트(사용자)의 요청을 전달하기 위해 서버가 이해할 수 있는 메시지(데이터)로 변환하고 전송 계층으로 전달하는 역할

- 클라이언트 측의 애플리케이션(웹 브라우저, 메일 프로그램..)이 서버 측의 애플리케이션(웹 서버 프로그램, 메일 서버 프로그램..)과 통신하기 위해선 **응용 계층의 프로토콜을 사용해야 한다.**
    - **응용 계층의 주요 프로토콜**
    
        | 프로토콜 | 내용 |
        | :---: | :---: |
        | **HTTP** (HyperText Transfer Protocol) | 웹 사이트 접속 |
        | **DNS** (Domain Name System) | 이름 해석 |
        | **FTP** (File Transfer Protocol) | 파일 전송 |
        | **SMTP** (Simple Mail Transfer Protocol) | 메일 송신 |
        | **POP3** (Post Office Protocol) | 메일 수신 |

## 📌 웹 서버의 구조

- WWW (= World Wide Web)는 HTML, URL, HTTP를 사용한다.
    
    - HTML (= HyperText Markup Language)
        
        - HyperText: 참조를 통해 한 문서에서 다른 문서로 접근할 수 있는 텍스트.

        - Markup: 문장의 일부를 태그로 감싸고 문장을 꾸미기 위한 형식
    
    - 클라이언트(웹 브라우저): **HTTP request(요청)** ↔️ 서버(웹 서버 프로그램): **HTTP response(응답)** 

        - 클라이언트의 HTTP request는 **GET**이란 하는 요청 정보, 파일 이름, 버전 등을 서버에 전송

        - 서버의 HTTP response는 request가 정상적으로 처리되었으면 **OK**라는 정보를 반환하고 클라이언트가 요청한 HTML을 봔환함

    - HTTP Version

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/176374668-a59b837c-46f0-4d7f-bcb7-90facefaf89e.jpg" width="900" height="400" />
</p>
        
## 📌 DNS 서버의 구조

- DNS(Domain Name System): URL을 IP 주소로 변환하는 서비스

    - 기본적으로 컴퓨터(서버)는 IP 주소가 있어서 인터넷을 통해 웹 서버에 접속함

    - 그러나 IP 주소는 숫자로 구성되어 있어 사람들이 외우기 쉽지 않음

    - **그래서 Domain Name을 사용하여 접속한다. DNS 서버는 사용자가 요청한 Domain의 IP주소를 확인하여 알려주며, 사용자의 컴퓨터는 DNS 서버에서 받은 IP주소를 확인하고 웹 서버에 접속한다.**

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/176374764-fe107786-5e89-49c7-bd8e-ccaf3d8a29db.jpg" width="900" height="500" />
</p>

## 📌 메일 서버의 구조

- SMTP: 메일을 송신할 때의 프로토콜 / POP3: 메일을 수신할 때의 프로토콜

<p align="center">
<img src="https://user-images.githubusercontent.com/84573261/176374848-10e02784-6d27-4ed9-9ecf-066f44554764.jpg" width="900" height="500" />
</p>


---

참고: [모두의 네트워크](http://www.yes24.com/Product/Goods/61794014)
